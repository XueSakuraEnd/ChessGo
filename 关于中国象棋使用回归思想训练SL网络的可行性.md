# 关于使用回归思想训练中国象棋SL网络的可行性

		本文旨在解决是否能够使用回归思想来训练中国象棋的SL网络.在此之前,先介绍一下阿尔法狗的SL网络,它是通过输入足够数量的人类专家的对战棋盘到CNN网络中,训练出当前状态下的着法策略的概率分布,由于围棋这种落子式的棋类,概率分布可以为19x19大小的向量,代表着棋盘内每一格的着法概率,这显然是一种分类思想.但是对于中国象棋这种移动式的棋类而言,使用这样的概率分布是不合适的,要使用着法策略的分布概率,但是着法策略的数量不是恒定的,并且表达的方式也比较麻烦,能不能使用别的方式去解决这个问题呢?首先需要了解以下的几个知识点

![](https://raw.githubusercontent.com/XueSakuraEnd/Picgo/main/Source/202305071127147.png)

>  AlphaGo的SL网络训练过程

        Zobrist键值:Zobrist键值是一种使用64位哈希随机数来区分不同局面的算法,在中国象棋里,具体的实现方法是初始化一个7x2x64的数组,三个维度分别代表着棋子类型,棋子颜色和棋子位置,将每个元素都用64位的随机数填满.而要为一个局面生成Zobrist键值,只需要用前一步的Zobrist异或随机数组里对应的随机数把原来的棋子去掉,再异或对应的随机数来表示移动后的棋子.能否很好的区分每个局面取决于随机数的位数以及其随机性,在中国象棋中64位的随机数已经能够保证不同局面而Zobrist值相同的情况出现的概率足够低.

$ChessBoard-^{hash⊕kill⊕move_{0}⊕move_{1}}->Zobrist$  

        既然有了Zobrist键值,我们就可以将棋局于Zobrist键值进行一一映射.但是这样还不够,想要应用回归思想,就必需保证这种映射关系是具有一定的线性关系,这就需要棋局具有一定的顺序排列,由于棋局是由10x9的数组表达,我并没有找到很好的方式来规则化排序方式,于是想到了一个Zobrist序列化的方法

        Zobrist序列化:由于异或的特性,Zobrist的数值上在一定程度上表示了当前棋盘的复杂性,则可以通过对Zobrist的排序来规范化棋局,经过排序后的棋局有两个特性,一个是与Zobrist键值有着极高的线性关系,第二个是有着棋局复杂度的逐步提升关系,这样对于应用在回归的CNN网络上有两个好处.一是对于线性关系的可行性,由于异或关系在CNN网络上面已经能够求解,加上高度的线性关系,这使得这种序列化的Zobrist键值对于回归CNN网络的训练是可行的,二是在预测上面,由于Zobrist的序列化,这使得从棋盘到Zobrist的映射更加简单,换句话来讲,就是找到Zobtist对应的棋盘这个过程更加简单了.

![](https://raw.githubusercontent.com/XueSakuraEnd/Picgo/main/Source/202305071202145.png)

> 以上是序列化和非序列化的Zobrist键值在10000多张盘棋和其中100步棋的比较

        可以看出来,用回归思想解决SL网络就是以无数的棋盘映射的Zobrist键值序列化而组成线性关系,实际上就是把一种n分类的任务转换成回归任务,这样虽然方便,但是也有缺陷.一是效率低,因为一步棋盘的策略分布并没有这么多的数量.二是存在着缺损值, 因为整个序列是通过有限的人类专家的对战棋盘来模拟出来的,不可能每个棋盘都存在序列中,而经过SL网络得出的输出值只能近似出该值附近的棋盘,而难免会漏掉一些更好的棋盘,这对于整盘游戏来说是有着致命缺陷的,所以这钟方法只能用作于最初始的策略概率估计.

![](https://raw.githubusercontent.com/XueSakuraEnd/Picgo/main/Source/202305071215001.png)

> SL网络训练过程的损失值变化
